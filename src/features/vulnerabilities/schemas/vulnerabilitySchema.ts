import { z } from "zod";

export const vulnerabilitySchema = z.object({
    description: z.string().min(10, "La descripción debe tener al menos 10 caracteres"),
    cve: z.string().optional().nullable(),
    severity: z.preprocess(
        (val) => (val === "" ? undefined : Number(val)),
        z.number().min(0).max(10)
    ),
    assetId: z.string().uuid("Debes seleccionar un activo válido"),
    status: z.enum(['ABIERTA', 'MITIGADA', 'ACEPTADA']).default('ABIERTA'),
});

export type VulnerabilityFormData = z.infer<typeof vulnerabilitySchema>;
